# Cilium与Hubble

## Cilium

Cilium是一个开源软件，旨在对应用服务间的网络连接进行透明加固，这些应用服务都是用Docker或者Kubernetes这种Linux容器管理平台部署的。

Cilium的技术底座就是所谓的eBPF，它能够动态的插入强大的安全观测能力和控制逻辑到Linux自身当中。由于eBPF是运行在Linux内核之中，Cilium可以对应用代码和容器配置无感知的情况下进行应用和更新。

## Hubble

[Hubble](../可观测性/使用Hubble进行网络观测.md)是一个分布式的网络和安全观测平台。它构建在Cilium和eBPF之上，对于服务和网络设施间的通信和行为，带来深度的可观测性，而且完全透明。

有了Cilium，Hubble就可以利用eBPF实现观测。有了eBPF，所有的观测都是可编程的，通过动态行为提供深入且详细的观测，同时还能最小化带来的损耗，满足用户需求。Hubble创建之初就是要尽全力发挥出eBPF的能力。

有了Hubble就可以回答下面的问题：

### 服务间的依赖与通信

- 哪些服务在相互通信？有多频繁？服务依赖关系图是怎样的？
- 发起了怎样的HTTP请求？一个服务消费或发出了哪些Kafka topic的消息？

### 网络监控与告警

- 是否有网络异常发生？为什么异常？是DNS的问题吗？还是程序或网络的问题？问题出在4层还是7层？
- 过去5分钟内哪些服务遇到了DNS解析的问题？最近有哪些服务遇到了TCP连接中断或超时的问题？未响应的TCP SYN请求频率是多少？

### 应用监控

- 某个服务或整个集群的HTTP 4xx或5xx的频率是多少？
- 在我的集群中，HTTP请求和响应延迟的95和99百分位是多少？哪些服务最慢？某两个服务之间的延迟是多少？

### 安全可观测性

- 哪些服务由于网络策略导致连接被阻断？哪些服务被集群外部访问？某个DNS名称被哪些服务解析了？

## 为什么选择Cilium+Hubble？

eBPF为系统和程序带来的可见性和控制力，这种粒度和效率都是前所未有的。它以完全透明的方式进行，不需要应用程序做任何改动。对于现代的容器化应用，以及传统的虚拟机应用或标准的Linux进程，eBPF都能够实现完全相同的功能。

