# 介绍

Linux内核为网络提供了一系列的BPF钩子，用来运行BGP程序。Cilium datapath利用这些钩子来加载BPF程序，提供更高层面的功能。

下面是Cilium用到的钩子列表以及相关描述。对于每个钩子的细节见[BPF和XDP参考](../../参考手册/BPF和XDP/BPF和XPD.md)。

- **XDP：**这个钩子是在网络驱动中时间点最早的一个钩子，一收到数据包就会触发BPF程序运行。这里可以实现数据包处理的最佳性能，因为其他任何处理程序此时还都没开始。这个钩子适合用来做一些过滤，比如丢弃恶意的或者未预料的流量，以及一些常见的DDOS防御机制。
- **Traffic Control Ingress/Egress：**Traffic Control（tc）钩子上的BPF程序是挂到了网络接口上，和XDP类似，但是是在数据包的初始处理之后运行。这个钩子在3层网络之前运行，但是又能够拿到数据包的大部分元数据。这对于节点相关的处理很有帮助，比如应用3、4层策略，重定向流量到endpoint。对于面向网络的设备，tc ingress钩子可以跟XDP钩子一起用。当它处理完成后，就可以合理的假设该流量此时大体上是合法且指向该节点的。
- **Socket操作：**这个钩子绑在特定的cgroup上，由TCP事件触发。